{% extends 'base.html' %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Packaging Rules</h2>
    <a class="btn btn-primary" href="{% url 'storage:packaging_create' %}">Add New Packaging</a>
  </div>
  <div class="card shadow-sm">
    <div class="table-responsive">
      <table class="table table-striped mb-0">
        <thead>
          <tr>
            <th>Product</th>
            <th>Pack Size (ml)</th>
            <th>Packets / Carton</th>
            <th>Bulk price</th>
            <th>Example (cartons → units)</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for item in packages %}
          <tr>
            <td>{{ item.pkg.product.name }}</td>
            <td>{{ item.pkg.pack_size_ml }}</td>
            <td>{{ item.pkg.packets_per_carton }}</td>
            <td>
              {% if item.pkg.bulk_price_per_carton %}
                KES {{ item.pkg.bulk_price_per_carton }} / carton
              {% else %}
                —
              {% endif %}
            </td>
            <td>{{ item.example_cartons }} carton(s) = {{ item.total_units }} units</td>
            <td class="text-end">
              <a class="btn btn-sm btn-outline-primary" href="{% url 'storage:packaging_detail' item.pkg.pk %}">View</a>
              <a class="btn btn-sm btn-outline-secondary" href="{% url 'storage:packaging_edit' item.pkg.pk %}">Edit</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" class="text-center text-muted py-4">No packaging rules defined.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}